---
title: "[리눅스 - 쉘 프로그래밍] 1. 리눅스와 쉘"
date: 2023-04-08 09:00:00 +0900
categories: [임베디드, 리눅스]
tags: [devrunner, imbedded, linux, shell programming, shell]
---

## 임베디드에서 리눅스를 쓰는 이유

---

리눅스는 다음과 같은 3가지 특성을 가지는 운영체제이다.

- **유연성**: 목적에 맞게 개조 가능
- **안정성**: 치명적인 오류 발생으로부터 어느정도 자유로움
- **오픈소스**: 여러 개발자들에 의해 지속적으로 유지보수되고, 무료다.

또한 동시 동작이 필요한 시스템에서는 운영체제가 필요하다.
리눅스 같은 경우 위와 같은 특성을 비롯해 타 OS들에 비해 우수한 멀티태스킹과 다양한 하드웨어 플랫폼에서 실행 가능하다는 장점 때문에 임베디드 시스템에서 널리 쓰인다.

## OS

---

### 기본 구조

---

![image](https://user-images.githubusercontent.com/87963766/227402928-105ed149-4b2c-489f-8972-e297194c45aa.png)

OS는 위와 같이 **Kernel + Shell + App**의 구조로 이루어져 있다.

여기서 커널은 **OS의 핵심 소스코드**이다.

그리고 리눅스는 바로 이 **커널**에 해당된다.

리눅스에 App, Shell을 얹은 게 우분투와 같은 "**리눅스 배포판**", 즉 리눅스 기반 운영체제이다.

### OS에서 시간의 중요성

---

OS에서 모든 작업은 시간을 기반으로 수행되기 때문에 시간은 굉장히 중요하다.리눅스 시스템에서는 시간 개념이 **하드웨어**의 시간과 **소프트웨어**의 시간, 이 두 가지로 나뉜다.

- **H/W**(하드웨어) 시간: 하드웨어에 내장된 시계를 기반으로 설정되는 시간으로, 하드웨어에 치명적인 문제가 생기지 않는 이상 100%의 정확도를 가진다.

- **S/W** (소프트웨어) 시간: OS 자체에서 설정되는 시간으로, 이 시간을 기반으로 OS가 구동된다.

그러나 발열이 발생하면 S/W 시간이 부정확해질 수 있다.
CPU, MCU, MPU와 같은 시스템을 구동시키는 하드웨어 내부에는 clock이 존재하는데, 발열 발생 시 전자의 이동 속도가 달라지기 때문에 해당 현상이 발생한다.

따라서 시스템이 제대로 동작하기 위해서는 **H/W 시간과 S/W 시간의 동기화**가 필수적이다.

## Shell

---

우리가 평상시에 쓰는 윈도우를 포함한 모든 OS는 커널 위의 Shell을 통해 사용자와 상호작용이 이뤄진다.
즉 Shell은 **OS의 인터페이스**다. 이런 식으로 커널을 감싸는 형태 때문에 Shell이란 이름을 쓴다.

여기서 인터페이스란, "**사용자와 기기가 상호작용을 하도록 돕는 시스템**"을 말한다.

윈도우의 경우 GUI Shell을 주로 사용하고, 리눅스는 CLI Shell을 쓴다.

![powerShell](https://user-images.githubusercontent.com/87963766/227414719-caa1f804-4605-4f8e-aff3-f9196b5d3643.jpg)

###### <center>윈도우에도 "파워쉘"이란 CLI Shell이 따로 존재한다.<center>

## 패키지 관리 시스템

---

우분투에는 패키지 설치 방법이 2가지다.

### apt 패키지 관리 도구

---

- CLI 기반

- 이미 빌드 된 패키지(Binary 형태)로 배포

- 소스코드 형태로도 배포

- 설치에 필요한 의존 패키지들을 자동으로 설치해줌

### 우분투 소프트웨어(우분투 자체 패키지 도구)

---

- GUI 기반

- Binary 형태로 배포

문제점이 있다면, 설치한 앱을 패키지 설치 도구끼리 독립적으로 관리한다는 점이다.
때문에 충돌한다거나 꼬이는 문제가 발생할 수 있다.
그러니 웬만하면 apt로 설치하자.

## 리눅스 파일 시스템

---

### 파일, 프로그램 삭제

---

리눅스에서 삭제는 함부로 하면 안된다.
다시 복구하는 게 꽤 힘들기 때문이다.

### 파일 관리의 시작점

---

드라이브(예: "`C:\`") 별로 파일 관리가 시작되는 윈도우와 달리, 리눅스는 "`/`"에서 파일 관리가 시작된다.

이 "`/`"를 **root**라 한다.

### 확장자

---

리눅스는 확장자 개념이 없다.
또한 모든 것이 파일 형태로 되어있다.
명령어마저 파일로 저장되어 있다.

### 윈도우와 리눅스의 디렉토리 차이

---

|      윈도우      | 리눅스  |
| :--------------: | :-----: |
| `Program Files`  | `/bin`  |
| `Windows System` | `/sbin` |
|    `"사용자"`    | `/home` |

### 링크

---

리눅스에서 바로가기는 "링크"라고 한다.

링크의 종류는 다음과 같다.

- 하드 링크

- 소프트 링크(많이 쓰임)

## 터미널

---

### 단축키

---

|       단축키       |                기능                 |
| :----------------: | :---------------------------------: |
|  `ctrl + alt + t`  |             터미널 열기             |
|       `F11`        |              전체 화면              |
| `Ctrl + Shift + t` |             새 탭 열기              |
| `Alt + 1, 2, 3...` |               탭 전환               |
| `Ctrl + Shift + w` |               탭 닫기               |
|  `Ctrl + Insert`   |                복사                 |
|  `Shift + Insert`  |              붙여넣기               |
|     `Ctrl + S`     |       Stop. 터미널이 멈춘다.        |
|     `Ctrl + Q`     | Start. 멈춘 터미널이 다시 시작한다. |

### 여러가지 유용한 명령어

---

- `sudo shutdown -h now`: 시스템 종료

- `history`: 명령 내역 조회

  - `!"번호"`: 해당 번호의 기록 명령어를 그대로 수행

- `wget "이미지 URL"`: 이미지 다운로드

- `man "명령어"`: 해당 명령어의 사용법 표시

- `dmesg`: 커널 메세지(log) 출력

- `date`: 현재 시간 출력

- `uptime`: 현재 시간, 부팅 후 지난 시간, 접속자 수, CPU 시스템 부하율(1분, 15분, 15분 평균치)를 출력

### 파일 조회 명령어

---

- `ls`: 하위 파일, 디렉토리 조회

  - `-a`: all, 숨김파일까지 출력

  - `-l`: list, 리스트 형태로 상세 정보 조회

- `pwd`: 현재 디렉토리 확인

- `clear`: 화면 지우기

- `cd "디렉토리 옵션"`: 디렉토리 이동

  - `..`: 상위 디렉토리

  - `"디렉토리명"`: 해당 이름의 디렉토리

  - `~`: 홈 디렉토리

  - `-`: 이전 디렉토리

- `cat "파일명"`: 해당 파일 내용 조회

### 파일 관리 명령어

---

1. 파일 생성, 삭제

- `touch "파일명"`: 새 빈 파일 생성. 이미 존재하는 파일일 경우, 변경된 시간을 현재 시간으로 업데이트 함.

- `rm "파일명"`: 파일 삭제

- `mkdir "디렉토리명"`: 디렉토리 생성

  - `-p`: 디렉토리 하위메뉴까지 모두 한꺼번에 생성

  - 예시:

    ```bash
      $mkdir -p ./aaa/bbb/ccc/ddd
    ```

- `rmdir "디렉토리명"`: 디렉토리 삭제

- `rm -r "경로"`: 해당 경로 내부를 재귀적으로(**r**ecursive) 돌며 모든 파일을 삭제한다는 뜻. 위 명령어보다 더 편하니 이걸 쓰자.

2. 파일 이동

- `mv "파일" "디렉토리"`: 디렉토리로 파일 옮기기

- `mv "파일" "파일 이름"`: 파일 이름 바꾸기

- `cp "파일" "경로"`: 파일을 해당 경로로 복사

  - `-r`: 디렉토리 복사하기(위의 `rm -r`처럼 사용하면 된다)

## apt 패키지 관리 도구 명령어

---

- `sudo apt install "프로그램 이름"`: 프로그램 설치

- `sudo`: 관리자 권한으로 명령어 수행

- `sudo apt install "프로그램명"`: 프로그램 설치

- 설치할 때 `sudo`라는 권한(`root` 권한)을 가진 계정만 설치 가능(리눅스 시스템 자체가 다수가 시스템에 접속해 여러 작업을 하는 시스템이기 때문에 권한을 기반으로 이러한 인증이 필요하다)

- `apt list`: 전체 패키지 목록 확인

  - `--installed`: 설치된 패키지 확인

- `apt show "패키지 이름"`: 패키지 정보 확인

- `apt purge`: 패키지 삭제

  - `apt remove`: 패키지 설정 파일을 남겨두고 패키지 삭제

### **\*참고**) `apt` vs `apt-get`

- `apt` 사용을 권장(라즈베리에서는 반대임)

- `apt` = `apt-cache` + `apt-get`

  - `apt-cache`: 패키지를 검색해 상세 정보를 조회 - `apt-get`: 패키지 설치, 삭제
